-# coding: utf-8
- content_for :javascripts do
  = javascript_include_tag 'analize'
%script#personContext{:type => "text/x-handlebars", "data-template-name" => "contextTemplate"}
  .breadcrumb
    %a{:href => "/documents/#{@document.id}"}
      = @document.heading
    >
    %a{:href => "/person/{{id}}"}
      {{name}}
    .information
      %ul
        %li
          Tags: 
          {{#tags}}
          %a{:href => "{{tag_link}}"}
            {{tag_name}}
          {{/tags}}
%script#paragraphTemplate{:type => "text/template"}
  {{#paragraphs}}
  %p{"data-paragraph" => "{{id}}"}
    {{{content}}}
  {{/paragraphs}}
%script#nextPageTemplate{:type => "text/template"}
  %a{:href => "{{url}}", :id => "next_page", "data-next" => "{{next_page}}", "data-document" => "{{id}}" }
    Cargar más contenido

- content_for :sidebar do
  %ul.nav.nav-list
    %li.nav-header
      Referencias
    %ul#reference
      %li.people
        %span Personas
        %input{:type => "checkbox", :checked => true}
      %li.organizations
        %span Organizaciones
        %input{:type => "checkbox", :checked => true}
      %li.places 
        %span Lugares
        %input{:type => "checkbox", :checked => true}
      %li.dates
        %span Fechas
        %input{:type => "checkbox", :checked => true}
      %li.actions
        %span Acciones
        %input{:type => "checkbox", :checked => true}
      %li.others
        %span Otros
        %input{:type => "checkbox", :checked => true}
    %li.nav-header
      Eventos
      .event.new.empty{:ondragover => "event.preventDefault()"}
    %li.nav-header Contexto
    .context
      .breadcrumb
        Document.. > Samuel
      .information
        %ul
          %li
            Tags: Conadep, Desaparecido
          %li
            Documentos: Fundamentos ABO, Veredicto ABO, ...

.row-fluid
  %h2
    = @document.heading
  .paragraphs
    - @paragraphs.each do |p|
      %p{"data-paragraph" => p.id}
        = paragraph_with_tagged_named_entities(p)
  .span4

.row-fluid
  .pages
  - if @paragraphs.length > 1
    .next_page
      = link_to "Cargar más contenido", url_for(:documents, :comb, :id => @document.id, :page => params[:page].to_i + 2),
        :id => "next_page",
        "data-next" => params[:page].to_i + 2,
        "data-document" => @document.id
    #loading{:style => "display:none; text-align: center;"}
      = image_tag 'ajax-bar-loader.gif', :style => "margin:0 auto;"
